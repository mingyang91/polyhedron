import{a as V,B as j,s as W,b as H,e as z,f as F,o as y,c as L,r as x,g as P,m as w,h as J,i as f,j as A,k as X,u as K,l as E,n as k,p as $,q as Q,w as O,t as Y,d as C,v as t,x as Z,y as ee,z as ae,A as se,C as S,D as I,E as b,F as ne,G as te,H as oe,M as re,I as le,_ as ie,J as ce}from"./index-6877406e.js";import{s as ue,a as de,u as pe,X as me,S as ve,_ as fe,c as ye}from"./ScrollableContent-3b2edde3.js";const ge=V("CircleIcon",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),Ie=V("SquareDotIcon",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}]]);var Pe=`
@layer primevue {
    .p-inline-message {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        vertical-align: top;
    }
    
    .p-inline-message-icon {
        flex-shrink: 0;
    }

    .p-inline-message-icon-only .p-inline-message-text {
        visibility: hidden;
        width: 0;
    }

    .p-fluid .p-inline-message {
        display: flex;
    }
}
`,_e={root:function(s){var n=s.props,l=s.instance;return["p-inline-message p-component p-inline-message-"+n.severity,{"p-inline-message-icon-only":!l.$slots.default}]},icon:function(s){var n=s.props;return["p-inline-message-icon",n.icon]},text:"p-inline-message-text"},be=j.extend({name:"inlinemessage",css:Pe,classes:_e}),he={name:"BaseInlineMessage",extends:X,props:{severity:{type:String,default:"error"},icon:{type:String,default:void 0}},style:be,provide:function(){return{$parentInstance:this}}},G={name:"InlineMessage",extends:he,timeout:null,data:function(){return{visible:!0}},mounted:function(){var s=this;this.sticky||setTimeout(function(){s.visible=!1},this.life)},computed:{iconComponent:function(){return{info:W,success:H,warn:z,error:F}[this.severity]}}};function Se(e,s,n,l,i,u){return y(),L("div",w({"aria-live":"polite",class:e.cx("root")},e.ptm("root")),[x(e.$slots,"icon",{},function(){return[(y(),P(J(e.icon?"span":u.iconComponent),w({class:e.cx("icon")},e.ptm("icon")),null,16,["class"]))]}),f("span",w({class:e.cx("text")},e.ptm("text")),[x(e.$slots,"default",{},function(){return[A("Â ")]})],16)],16)}G.render=Se;var r=(e=>(e.STOPPED="STOPPED",e.RECORDING="RECORDING",e.UNAVAILIABLE="UNAVAILIABLE",e.PENDING="PENDING",e.STOPPING="STOPPING",e.PAUSED="PAUSED",e))(r||{});const ke="/assets/worklet-processer-856fc525.js";const De=e=>{const{audioInputs:s,audioOutputs:n,...l}=K({requestPermissions:!0,constraints:{audio:!0,video:!1},onUpdated:e==null?void 0:e.onUpdated}),i=E(()=>s.value.map(a=>({label:a.label,deviceId:a.deviceId,value:a.deviceId,groupId:a.groupId,kind:a.kind}))),u=E(()=>n.value.map(a=>({label:a.label,deviceId:a.deviceId,value:a.deviceId,groupId:a.groupId,kind:a.kind})));return{...l,SpeakerList:u,micphoneList:i}},Ne=async e=>await navigator.mediaDevices.getUserMedia({audio:{deviceId:e}}),we=e=>{const s=k(r.UNAVAILIABLE),n=$(),l=$(),i={source:void 0,processor:void 0},u=async o=>{var D;if(s.value===r.RECORDING)return;s.value=r.PENDING,n.value=new AudioContext({latencyHint:"interactive"}),await n.value.audioWorklet.addModule(ke),l.value&&l.value.getTracks().forEach(g=>g.stop()),l.value=await Ne(o);const v=n.value.createMediaStreamSource(l.value),p=new AudioWorkletNode(n.value,"recorder.worklet");p.connect(n.value.destination),v.connect(p),i.source=v,i.processor=p,n.value.resume(),s.value=r.RECORDING,p.port.onmessage=g=>{var _;(_=e==null?void 0:e.ondata)==null||_.call(e,g.data)},p.port.onmessageerror=g=>{var _;(_=e==null?void 0:e.onerror)==null||_.call(e,g),a()},(D=e==null?void 0:e.onstart)==null||D.call(e)},a=async()=>{var p;if(s.value===r.STOPPED)return;s.value=r.STOPPING;const{source:o,processor:v}=i;l.value&&ue(l.value),o==null||o.disconnect(),v==null||v.disconnect(),n.value&&(await n.value.close(),i.processor=void 0,i.source=void 0),n.value=void 0,s.value=r.STOPPED,(p=e==null?void 0:e.onclose)==null||p.call(e)},d=Q({name:"microphone"});return O(d,o=>{o==="granted"?s.value=r.STOPPED:s.value=r.UNAVAILIABLE},{immediate:!0}),{status:Y(s),context:n,stream:l,startRecord:u,stopRecord:a}},Ee=C({__name:"MediaSelector",props:{disabled:{type:Boolean,default:!1},modelValue:{type:String,default:""}},emits:["update:modelValue"],setup(e,{emit:s}){const n=e,l=s,{micphoneList:i}=De(),u=k(n.modelValue),a=E({get:()=>u.value,set:d=>{u.value=d,l("update:modelValue",d||"default")}});return O(()=>n.modelValue,d=>{a.value=d}),O(i,d=>{d.length&&!a.value&&(a.value=d[0].value)},{immediate:!0,deep:!0}),(d,o)=>{const v=de;return y(),P(v,{disabled:e.disabled,"model-value":a.value,"onUpdate:modelValue":o[0]||(o[0]=p=>a.value=p),options:t(i),"option-label":"label","option-value":"value"},null,8,["disabled","model-value","options"])}}}),$e={class:"main-header un-justify-between"},Oe=f("h1",{class:"main-header-title"},"Lession - Teacher",-1),xe={class:"main-header-actions un-gap-3"},Ve={class:"side-view"},Le=C({name:"ViewLession",__name:"index",props:{id:{type:String,required:!0}},setup(e){const s=e,n=Z(),l=ee(s,"id"),i=k("en-US"),u=k(),a=$(),d=k("closed"),{status:o,startRecord:v,stopRecord:p}=we({onstart(){var c;a.value&&((c=a.value)==null?void 0:c.ws.readyState)===WebSocket.OPEN&&a.value.close(),a.value=ye(`/ws/teacher?id=${l.value}&language=${i.value}&prompt=`,{onopen(){d.value="connected"},onerror(m){},onclose(){d.value="closed",p()},onmessage(m){_(m)}})},ondata(c){var m;(m=a.value)==null||m.send(c)},onclose(){R()}}),D=async()=>{u.value&&await v(u.value)},g=async()=>{var c;(c=a.value)==null||c.close(),await p()},{onmessage:_,currentText:B,originals:M,cleanScreen:R}=pe();return ae(()=>{o.value!==r.STOPPED&&o.value!==r.STOPPING&&g()}),(c,m)=>{const h=le,U=ie,T=G,q=se("tooltip");return y(),P(re,null,{default:S(()=>[f("header",$e,[Oe,f("aside",xe,[I(h,{severity:"secondary",label:"Escape",onClick:m[0]||(m[0]=()=>c.$router.push({name:"home"}))},{icon:S(()=>[I(t(me),{class:"p-icon un-mr-3"})]),_:1})])]),f("main",{class:b(["main-body",[c.$style.main]])},[f("aside",Ve,[I(U,{class:b([c.$style["personal-appearance"]]),name:t(n).name,role:t(n).role},null,8,["class","name","role"])]),f("section",{class:b([c.$style["main-view"]])},[f("section",{class:b([c.$style["text-content"]])},[I(ve,{class:"un-flex-1",contents:t(M),current:t(B)},null,8,["contents","current"])],2),f("section",{class:b([c.$style.bar])},[I(fe,{class:"un-flex-1","model-value":i.value,"onUpdate:modelValue":m[1]||(m[1]=N=>i.value=N),disabled:t(o)!==t(r).STOPPED},null,8,["model-value","disabled"])],2),f("section",{class:b([c.$style.bar])},[I(Ee,{class:"un-flex-1","model-value":u.value,"onUpdate:modelValue":m[2]||(m[2]=N=>u.value=N),disabled:t(o)!==t(r).STOPPED},null,8,["model-value","disabled"]),t(o)!==t(r).UNAVAILIABLE?(y(),L(oe,{key:0},[t(o)===t(r).STOPPED?ne((y(),P(h,{key:0,severity:"danger",onClick:D},{icon:S(()=>[I(t(ge),{class:"p-icon"})]),_:1})),[[q,"Start",void 0,{bottom:!0}]]):t(o)===t(r).PENDING?(y(),P(h,{key:1,loading:"",label:"Starting"})):t(o)===t(r).RECORDING?(y(),P(h,{key:2,block:"",severity:"danger",label:"Stop",onClick:g},{icon:S(()=>[I(t(Ie),{class:"p-icon"})]),_:1})):t(o)===t(r).STOPPING?(y(),P(h,{key:3,loading:"",label:"Stopping"})):te("",!0)],64)):(y(),P(T,{key:1,severity:"info"},{default:S(()=>[A(" Micphone is not available. ")]),_:1}))],2)],2)],2)]),_:1})}}}),Ae="_main_113lr_2",Ce="_options_113lr_9",Ge="_bar_113lr_22",Be={main:Ae,options:Ce,"main-view":"_main-view_113lr_16",bar:Ge,"text-content":"_text-content_113lr_33"},Me={$style:Be},Te=ce(Le,[["__cssModules",Me]]);export{Te as default};
